# ğŸ“ˆ å› å­æŠ•è³‡ç³»çµ± Factor Investing System

## ğŸ§­ å°ˆæ¡ˆä»‹ç´¹

æœ¬å°ˆæ¡ˆç‚ºä¸€å€‹æ¨¡çµ„åŒ–çš„ã€Œ**å› å­æŠ•è³‡ç³»çµ±**ã€ï¼Œæ•´åˆäº†å› å­è³‡æ–™æ•´ç†ã€å ±é…¬åˆ†æã€è¦–è¦ºåŒ–èˆ‡æŠ•çµ„ç¸¾æ•ˆè©•ä¼°åŠŸèƒ½ã€‚  
é€éè‡ªå‹•åŒ–çš„è³‡æ–™åŒ¯å…¥èˆ‡åˆ†ææµç¨‹ï¼Œä½¿ç”¨è€…å¯å¿«é€Ÿå®Œæˆä»¥ä¸‹å·¥ä½œï¼š

- ğŸ“Š åŒ¯å…¥èˆ‡æ›´æ–°å› å­è³‡æ–™ï¼ˆè‡ªå‹•æ•´ä½µèˆŠæª”èˆ‡æ–°è³‡æ–™ï¼‰  
- âš™ï¸ ä¾æ™‚æœŸç”Ÿæˆå®Œæ•´å› å­å ±é…¬ç¸¾æ•ˆå ±è¡¨  
- ğŸ”¥ åˆ†æå„å› å­è¿‘æœŸè¡¨ç¾ã€è¦–è¦ºåŒ–æ¯”è¼ƒçµæœ  
- ğŸ“… æŸ¥è©¢ç•¶æœŸæŠ•è³‡çµ„åˆæŒè‚¡æ¸…å–®  
- ğŸ’¡ åˆ†ææŠ•çµ„ä¸­æœ€å…·è²¢ç»çš„å€‹è‚¡èˆ‡å ±é…¬åˆ†å¸ƒ  

æœ¬ç³»çµ±é©ç”¨æ–¼**å°è‚¡é‡åŒ–æŠ•è³‡ç­–ç•¥ç ”ç©¶ã€å› å­æœ‰æ•ˆæ€§æ¸¬è©¦ã€æˆ–æŠ•çµ„ç¸¾æ•ˆæ­¸å› åˆ†æ**ã€‚

---

## ğŸ—‚ å°ˆæ¡ˆæ¶æ§‹

```
ğŸ“ å°ˆæ¡ˆç›®éŒ„
â”‚
â”œâ”€â”€ merged_csvs/               # æ›´æ–°å¾Œçš„å› å­è³‡æ–™é›†ï¼ˆè‡ªå‹•è¼¸å‡ºè³‡æ–™å¤¾ï¼‰
â”‚
â”œâ”€â”€ __pycache__/               # Python å¿«å–ï¼ˆè‡ªå‹•ç”Ÿæˆï¼‰
â”‚
â”œâ”€â”€ alpha.py                   # å› å­é‚è¼¯å‡½æ•¸ï¼ˆAlpha è¨Šè™Ÿç”Ÿæˆï¼‰
â”œâ”€â”€ clean_data.py              # è³‡æ–™æ¸…ç†å‡½æ•¸
â”œâ”€â”€ eps_growth.py              # EPS æˆé•·ç‡å› å­é‚è¼¯
â”œâ”€â”€ import_lab.py              # åŒ¯å…¥èˆ‡è³‡æ–™è™•ç†å·¥å…·
â”œâ”€â”€ interval_report.py         # å ±è¡¨ç”Ÿæˆèˆ‡å¯è¦–åŒ–å‡½æ•¸
â”œâ”€â”€ pe.py                      # æœ¬ç›Šæ¯”å› å­é‚è¼¯
â”œâ”€â”€ portfo_analysis.py         # æŠ•çµ„ç¸¾æ•ˆèˆ‡æ­¸å› åˆ†æ
â”œâ”€â”€ revenue_growth.py          # ç‡Ÿæ”¶æˆé•·ç‡å› å­é‚è¼¯
â”œâ”€â”€ yeild.py                   # æ®–åˆ©ç‡å› å­é‚è¼¯
â”‚
â”œâ”€â”€ main.ipynb                 # ä¸» Notebookï¼šå› å­é‹ç®—èˆ‡å‡½æ•¸æ‡‰ç”¨
â”œâ”€â”€ update_data.ipynb          # æ›´æ–°è³‡æ–™æ™‚ä½¿ç”¨çš„ Notebook
â”‚
â”œâ”€â”€ å› å­è³‡æ–™å…¨.xlsx             # 2025-08-26 ä»¥å‰çš„è³‡æ–™
â”œâ”€â”€ æ›´æ–°å› å­.xlsx               # 2025-08-26 ä¹‹å¾Œè³‡æ–™ï¼ˆæ‰‹å‹•å¾ Cmoney æ›´æ–°ï¼‰
â”‚
â””â”€â”€ README.md                  # å°ˆæ¡ˆèªªæ˜æ–‡ä»¶ï¼ˆæœ¬æª”æ¡ˆï¼‰
```

---

## ğŸš€ æ•´é«”æ“ä½œæµç¨‹

1ï¸âƒ£ æ‰‹å‹•æ›´æ–° `æ›´æ–°å› å­.xlsx`ï¼ˆå¾ Cmoney åŒ¯å…¥æœ€æ–°è³‡æ–™ï¼‰  
â¬‡ï¸  
2ï¸âƒ£ åŸ·è¡Œ `update_data.ipynb`ï¼ˆå°‡æ–°è³‡æ–™æ•´ä½µè‡³ `merged_csvs/`ï¼‰  
â¬‡ï¸  
3ï¸âƒ£ é–‹å•Ÿ `main.ipynb`ï¼ˆä¸»è¦æ“ä½œå¹³å°ï¼‰  
â¬‡ï¸  
4ï¸âƒ£ åŒ¯å…¥ä¸¦å®šç¾©ä¸»è¦å› å­ï¼ˆå¦‚ `pe`, `revenue_growth`, `eps_growth`, `yeild`ï¼‰  
â¬‡ï¸  
5ï¸âƒ£ ä½¿ç”¨ä¸‹åˆ—å››å€‹æ ¸å¿ƒå‡½æ•¸é€²è¡Œåˆ†æèˆ‡è¦–è¦ºåŒ–  

---

# âš™ï¸ å‡½æ•¸èªªæ˜èˆ‡ä½¿ç”¨ç¯„ä¾‹

---

## å‡½æ•¸1ï¼šæŒ‡å®šå€é–“å› å­å ±é…¬å ±è¡¨  
ï¼ˆ`perf_report`ï¼‰

**åŠŸèƒ½**  
æ¯”è¼ƒå¤šå€‹æŠ•è³‡çµ„åˆæˆ–å› å­åœ¨æŒ‡å®šæœŸé–“å…§çš„ç¸¾æ•ˆï¼Œè¼¸å‡ºï¼š
- ç´¯ç©å ±é…¬æ›²ç·š  
- Sharpe Ratio / å¹´åŒ–å ±é…¬æ¯”è¼ƒåœ–  
- ç¸¾æ•ˆç¸½è¡¨ï¼ˆDataFrameï¼‰

**å®šç¾©**
```python
def perf_report(returns_dict: dict, start_date: str, end_date: str, 
                freq: int = 252, rf: float = 0.0)
```

**åƒæ•¸**
| åƒæ•¸ | å‹æ…‹ | èªªæ˜ |
|------|------|------|
| `returns_dict` | dict[str, pd.Series] | æ¯å€‹å› å­æˆ–ç­–ç•¥çš„æ—¥å ±é…¬ç‡ |
| `start_date`, `end_date` | str | åˆ†æå€é–“ |
| `freq` | int | å¹´åŒ–åŸºæ•¸ï¼ˆå°è‚¡é è¨­ 252ï¼‰ |
| `rf` | float | ç„¡é¢¨éšªåˆ©ç‡ï¼ˆé è¨­ 0ï¼‰ |

**è¼¸å‡º**
- åœ–è¡¨1ï¸âƒ£ï¼šç´¯ç©å ±é…¬æ›²ç·š  
- åœ–è¡¨2ï¸âƒ£ï¼šSharpe Ratio é•·æ¢åœ–  
- DataFrameï¼šå„ç­–ç•¥ç¸¾æ•ˆè¡¨ï¼ˆå«å¹´åŒ–å ±é…¬ã€æ³¢å‹•ã€Sharpeã€ç¸½å ±é…¬ï¼‰

**ç¯„ä¾‹**
```python
returns_dict = {
    "PE_Low": pe_low_returns,
    "PB_Low": pb_low_returns,
    "Momentum": mom_returns
}
perf_table = perf_report(returns_dict, "2024-01-01", "2024-12-31")
```

---

## å‡½æ•¸2ï¼šæœ€è¿‘ä¸€å¹´å› å­æœˆè¡¨ç¾ç†±åŠ›åœ–  
ï¼ˆ`factor_rank_tile` / `factor_rank_tile_full`ï¼‰

**åŠŸèƒ½**  
é¡¯ç¤ºå„å› å­åœ¨æ¯æœŸï¼ˆæœˆã€é€±ã€å¹´ï¼‰ä¸­çš„å–®æœŸå ±é…¬æ’åï¼Œ  
ä»¥**ç†±åŠ›åœ–å½¢å¼**å¯è¦–åŒ–å› å­å¼·å¼±èˆ‡ç©©å®šæ€§ã€‚

**å®šç¾©**
```python
def factor_rank_tile(
    returns_dict: dict,
    end_date: str | None = None,
    periods: int = 12,
    freq: str = "M",
    title: str = "Factor Ranking Tile Chart",
    save_html: str | None = None
)
```

**åƒæ•¸**
| åƒæ•¸ | å‹æ…‹ | èªªæ˜ |
|------|------|------|
| `returns_dict` | dict[str, pd.Series] | å„å› å­å ±é…¬ç‡ |
| `end_date` | str | çµæŸæ—¥æœŸï¼ˆè‡ªå‹•æŠ“å–æœ€å¤§æ—¥æœŸï¼‰ |
| `periods` | int | é¡¯ç¤ºæœ€è¿‘ N æœŸï¼ˆé è¨­ 12ï¼‰ |
| `freq` | str | é€±æœŸï¼š"M" æœˆ / "W" é€± / "Y" å¹´ |
| `title` | str | åœ–è¡¨æ¨™é¡Œ |
| `save_html` | str | å„²å­˜ HTML æª”è·¯å¾‘ï¼ˆå¯é¸ï¼‰ |

**è¼¸å‡º**
- æ–¹æ ¼åœ–ï¼ˆPlotlyï¼‰ï¼šé¡¯ç¤ºå› å­åã€å ±é…¬%èˆ‡ç•¶æœŸæ’å  
- DataFrameï¼šå„æœŸå ±é…¬èˆ‡æ’åçµæœ  

**ç¯„ä¾‹**
```python
factor_rank_tile(
    returns_dict=factor_returns_dict,
    end_date="2025-09-30",
    periods=12,
    freq="M"
)
```

---

## å‡½æ•¸3ï¼šç•¶æ—¥æŒè‚¡æ˜ç´°  
ï¼ˆ`porfolio_list`ï¼‰

**åŠŸèƒ½**  
æ ¹æ“šå› å­é¸è‚¡çŸ©é™£ï¼ˆ0/1ï¼‰æŸ¥è©¢æŸæ—¥æœŸçš„æŒè‚¡æ¸…å–®ã€‚

**å®šç¾©**
```python
def porfolio_list(alpha, date):
    return alpha.columns[(alpha.loc[date] == 1)]
```

**åƒæ•¸**
| åƒæ•¸ | å‹æ…‹ | èªªæ˜ |
|------|------|------|
| `alpha` | pd.DataFrame | é¸è‚¡è¨Šè™ŸçŸ©é™£ï¼ˆindex=æ—¥æœŸ, columns=è‚¡ç¥¨ä»£è™Ÿ, å€¼=0/1ï¼‰ |
| `date` | str | æŒ‡å®šæ—¥æœŸï¼ˆ`YYYY-MM-DD`ï¼‰ |

**è¼¸å‡º**
- `pd.Index`ï¼šè©²æ—¥æ‡‰æŒæœ‰è‚¡ç¥¨æ¸…å–®  

**ç¯„ä¾‹**
```python
tickers = porfolio_list(pe_low_01_alpha, "2025-01-20")
print(tickers)
# âœ Index(['1101', '1210', '2317', ...], dtype='object')
```

---

## å‡½æ•¸4ï¼šæŠ•è³‡çµ„åˆè²¢ç»æœ€å¤šçš„å€‹è‚¡  
ï¼ˆ`top_contributors_report`ï¼‰

**åŠŸèƒ½**  
åˆ†ææŒ‡å®šå€é–“å…§å„è‚¡ç¥¨å°æŠ•çµ„æ•´é«”ç¸¾æ•ˆçš„è²¢ç»åº¦ï¼Œ  
åŒæ™‚è¨ˆç®—å¹´åŒ–å ±é…¬ã€æ³¢å‹•ã€Sharpe Ratio èˆ‡å€é–“å ±é…¬ã€‚

**å®šç¾©**
```python
def top_contributors_report(
    returns, tickers, start_date, end_date,
    weights=None, top_n=10, annualize=252, risk_free_annual=0.0
)
```

**åƒæ•¸**
| åƒæ•¸ | å‹æ…‹ | èªªæ˜ |
|------|------|------|
| `returns` | pd.DataFrame | index=æ—¥æœŸ, columns=è‚¡ç¥¨ä»£è™Ÿ, å€¼=æ—¥å ±é…¬ç‡ |
| `tickers` | list[str] | æŠ•çµ„æˆåˆ†è‚¡ |
| `start_date`, `end_date` | str | åˆ†æå€é–“ |
| `weights` | dict[str, float] | æ¬Šé‡è¨­å®šï¼ˆé è¨­ç­‰æ¬Šï¼‰ |
| `top_n` | int | é¡¯ç¤ºå‰ N åè²¢ç»è€… |
| `annualize` | int | å¹´åŒ–åŸºæ•¸ï¼ˆ252ï¼‰ |
| `risk_free_annual` | float | å¹´åŒ–ç„¡é¢¨éšªåˆ©ç‡ |

**è¼¸å‡º**
- Bar Chartï¼šå‰ N åè²¢ç»å€‹è‚¡  
- DataFrameï¼šå„è‚¡ç¸¾æ•ˆæŒ‡æ¨™èˆ‡æŠ•çµ„å ±é…¬è²¢ç»  
- Floatï¼šæŠ•çµ„æœŸé–“ç¸½å ±é…¬  

**ç¯„ä¾‹**
```python
stats_df, port_ret = top_contributors_report(
    returns=returns,
    tickers=["2330", "2317", "2882", "2603"],
    start_date="2024-01-01",
    end_date="2024-12-31",
    top_n=10
)
```
